# Client/Server Separation - CRITICAL RULES

## ğŸš¨ NEVER Import Database in Client Components
**This causes TLS/Node.js import errors and will break the application!**

### âŒ FORBIDDEN in Client Components ("use client"):
- Database utilities from [db/](mdc:db/)
- Server-only functions from [utils/](mdc:utils/)
- Any Node.js specific imports
- Direct database queries

### âœ… Database Queries ONLY Allowed In:
- **Server components** (no "use client" directive)
- **Server actions** (with "use server" directive)
- **API routes** ([app/api/](mdc:app/api/))

## Data Flow Pattern
```
Server Component/Action â†’ Client Component
     (fetch data)         (receive as props)
```

### Example Pattern:
```typescript
// âœ… Server Component (layout.tsx)
export default async function Layout() {
  const companies = await getUserCompanies(); // OK - server component
  return <Sidebar companies={companies} />;   // Pass as props
}

// âœ… Client Component
"use client";
export function Sidebar({ companies }: { companies: Company[] }) {
  // Use companies prop, never import getUserCompanies here
}
```

## Common Error to Avoid
âŒ Importing `getUserCompanies()` in client sidebar components
âœ… Fetch in parent server component and pass as props

Reference [utils/](mdc:utils/) for available server utilities.
